---
import Layout from "src/layouts/Layout.astro";
import { CollectionEntry, getCollection } from "astro:content";
export async function getStaticPaths() {
  const pagesCollection = await getCollection("pages");
  const projectsCollection = await getCollection("projects");

  const getReturnData = (
    collection: CollectionEntry<"pages">[] | CollectionEntry<"projects">[]
  ) => {
    return collection.map((page) => {
      const [locale, ...rest] = page.slug.split("/");
      const slug = rest.join("/");
      return {
        props: {
          entry: page,
        },
        params: {
          locale,
          slug,
        },
      };
    });
  };

  const pagesReturnData = await getReturnData(pagesCollection);
  const projectsRturnData = await getReturnData(projectsCollection);

  return pagesReturnData.concat(projectsRturnData);
}

const { entry } = Astro.props;
const { Content } = await entry.render();

export const prerender = true;
---

<Layout title={entry.data.title}>
  <main>
    <Content />
  </main>
</Layout>
